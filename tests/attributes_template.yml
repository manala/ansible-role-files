---

- name: Attributes - Template
  hosts: all
  gather_facts: false
  pre_tasks:
    - shell: rm -rf /srv/tests/temp/*
  vars:
    foo: bar
    manala_files_attributes:
      - path:     /srv/tests/temp/file
        template: /srv/tests/fixtures/template.j2
  roles:
    - manala.files
  post_tasks:
    - name: Goss
      raw: "{{ 'echo \"' ~ item|to_yaml ~ '\"|goss -g - validate' }}"
      with_items:
        - file:
            /srv/tests/temp/file:
              exists:  true
              filetype: file
              contains:
                - Hello bar!
